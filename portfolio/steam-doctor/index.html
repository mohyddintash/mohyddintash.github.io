<!DOCTYPE html>
<html lang='en'><head>
  <title>STEAM DOCTOR - Mohyddin Tash</title>
  <link rel='canonical' href='https://mohyddin.tk/portfolio/steam-doctor/' />
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <meta name='description' content='Steeam-Powered Auto Sterializing Chamber' />
  <meta name='theme-color' content='#FD3519' />
  
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon" />
  

  <meta name="generator" content="Hugo 0.80.0" />

  





<link rel="stylesheet" href="https://mohyddin.tk/sass/style.min.8f6710aace87248d4d3eb9b3361cd40bec371f05cce13fbfc1eee9d86dbaeafb.css" integrity="sha256-j2cQqs6HJI1NPrmzNhzUC&#43;w3HwXM4T&#43;/we7p2G266vs=" media="screen">
<link rel="stylesheet" href="https://mohyddin.tk/syntax.min.css" integrity="" media="screen">

  <meta property="og:title" content="STEAM DOCTOR" />
<meta property="og:description" content="Steeam-Powered Auto Sterializing Chamber" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mohyddin.tk/portfolio/steam-doctor/" />
<meta property="article:published_time" content="2020-07-02T19:47:09+02:00" />
<meta property="article:modified_time" content="2020-07-02T19:47:09+02:00" />

  <meta itemprop="name" content="STEAM DOCTOR">
<meta itemprop="description" content="Steeam-Powered Auto Sterializing Chamber">
<meta itemprop="datePublished" content="2020-07-02T19:47:09+02:00" />
<meta itemprop="dateModified" content="2020-07-02T19:47:09+02:00" />
<meta itemprop="wordCount" content="1056">



<meta itemprop="keywords" content="" />

</head>
<body>

  <header style="background-image:linear-gradient(
      rgba(0,0,0,0.4),rgba(0,0,0,0.4)
    ),url(&#39;https://mohyddin.tk/images/lebanon-night.jpg&#39;)">
  <div class="intro">
    <div class="logo-container">
      <a href="/">
        <img src='https://mohyddin.tk/images/me.jpeg' alt="Profile Pathfinder" class="rounded-logo">
      </a>
    </div>
    <h2>Hi, I'm Mo üëã</h2>
    <h3>I'm a Software Developer üíª from Lebanon üá±üáß</h3>
    <div class="menu">
      

        <p>
            <a href="/about/">
                About
            </a>
        </p>

        <p>
            <a href="/portfolio/">
                Portfolio
            </a>
        </p>

      
        
        <p>
            <a href="mailto:mohyddintash@gmail.com" target="_blank" rel="external">
                Say Hi!  üì¢
            </a>
        </p>
      
    </div>

  </div>

  <div class="socials">
      
  
    <a href="https://github.com/mohyddintash" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM71.182 98.494c-2.156.385-2.952-.95-2.952-2.053 0-1.386.051-8.471.051-14.195 0-4.005-1.335-6.546-2.9-7.881C74.878 73.313 84.89 72.003 84.89 55.6c0-4.671-1.669-7.007-4.39-10.01.436-1.105 1.9-5.648-.436-11.552-3.568-1.104-11.731 4.595-11.731 4.595-3.389-.95-7.06-1.438-10.679-1.438-3.62 0-7.29.488-10.679 1.438 0 0-8.163-5.699-11.73-4.595-2.337 5.878-.899 10.422-.437 11.551-2.72 3.004-4.004 5.34-4.004 10.011 0 16.326 9.574 17.712 19.072 18.765-1.232 1.104-2.336 3.003-2.72 5.724-2.44 1.104-8.677 3.004-12.4-3.568-2.335-4.056-6.545-4.39-6.545-4.39-4.159-.05-.282 2.619-.282 2.619 2.772 1.283 4.723 6.212 4.723 6.212 2.49 7.624 14.4 5.057 14.4 5.057 0 3.568.052 9.37.052 10.422 0 1.104-.77 2.438-2.952 2.053C27.21 92.821 15.35 76.701 15.35 57.86c0-23.564 18.02-41.456 41.585-41.456s42.663 17.892 42.663 41.456c.026 18.842-11.474 34.988-28.416 40.635zM46 82.81c-.488.103-.95-.102-1.001-.436-.051-.385.282-.719.77-.822.488-.05.95.154 1.001.488.077.334-.257.668-.77.77zm-2.439-.23c0 .333-.385.615-.898.615-.565.052-.95-.23-.95-.616 0-.333.385-.616.899-.616.487-.051.95.231.95.616zm-3.516-.283c-.103.334-.616.488-1.053.334-.488-.103-.821-.488-.719-.822.103-.334.617-.488 1.053-.385.513.154.847.54.719.873zm-3.158-1.386c-.23.282-.718.23-1.104-.154-.385-.334-.487-.822-.23-1.053.23-.282.718-.23 1.103.154.334.334.462.847.231 1.053zm-2.336-2.336c-.23.154-.667 0-.95-.385-.282-.385-.282-.822 0-1.001.283-.231.72-.052.95.333.283.385.283.847 0 1.053zm-1.668-2.49c-.231.23-.616.103-.899-.154-.282-.334-.333-.719-.102-.899.23-.23.616-.102.898.154.282.334.334.72.103.899zm-1.72-1.9c-.103.231-.436.283-.719.103-.334-.154-.488-.436-.385-.667.103-.154.385-.231.719-.103.334.18.488.462.385.667z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://www.linkedin.com/in/mohyddin-tash-565ab738/" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M106.786 0H8.189C3.67 0 0 3.722 0 8.291v98.418C0 111.278 3.67 115 8.189 115h98.597c4.518 0 8.214-3.722 8.214-8.291V8.29C115 3.722 111.304 0 106.786 0zm-72.03 98.571H17.713V43.69h17.07V98.57h-.025zm-8.522-62.377c-5.467 0-9.882-4.44-9.882-9.883 0-5.442 4.415-9.882 9.882-9.882 5.442 0 9.883 4.44 9.883 9.882a9.87 9.87 0 0 1-9.883 9.883zm72.414 62.377H81.604V71.875c0-6.366-.129-14.555-8.856-14.555-8.882 0-10.242 6.931-10.242 14.093V98.57H45.46V43.69h16.352v7.495h.23c2.285-4.312 7.855-8.856 16.147-8.856 17.25 0 20.458 11.372 20.458 26.158V98.57z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://stackoverflow.com/users/4016215/motash" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M83.108 71.618L32.873 61.017l-2.105 10.088 50.235 10.524 2.105-10.01zM96.2 49.286L56.797 16.352l-6.546 7.906 39.403 32.934 6.546-7.906zm-8.01 10.19L41.653 37.735l-4.287 9.37 46.513 21.69 4.313-9.317zM75.742 0l-8.214 6.16L98.15 47.31l8.214-6.162L75.741 0zm5.262 84.196H29.664v10.191h51.34v-10.19zm10.191 20.536H19.448V73.93H9.18V115h92.282V73.929H91.194v30.803z" />
  
  </svg>
</div>
</a>
  

  
    <a href="https://twitter.com/mohyddin/" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM90.126 40.763c.051.72.051 1.464.051 2.182 0 22.256-16.942 47.9-47.9 47.9-9.548 0-18.404-2.772-25.848-7.547 1.36.154 2.67.205 4.055.205 7.881 0 15.12-2.67 20.895-7.187-7.392-.154-13.604-5.006-15.735-11.68 2.593.385 4.929.385 7.598-.308a16.837 16.837 0 0 1-13.476-16.531v-.205a16.824 16.824 0 0 0 7.598 2.13 16.8 16.8 0 0 1-7.496-14.016c0-3.131.822-6.006 2.285-8.496a47.803 47.803 0 0 0 34.705 17.61c-2.387-11.424 6.161-20.69 16.429-20.69 4.851 0 9.215 2.027 12.296 5.313a32.99 32.99 0 0 0 10.678-4.056 16.792 16.792 0 0 1-7.393 9.267c3.389-.36 6.674-1.31 9.703-2.618a35.437 35.437 0 0 1-8.445 8.727z"/>
  
  </svg>
</div>
</a>
  

  </div>

</header>

  <div class="content-wrapper">
    
      <div class="breadcrumb">
  





<span >
  <a href="https://mohyddin.tk/">HOME</a>
   / 
</span>


<span >
  <a href="https://mohyddin.tk/portfolio/">PORTFOLIO</a>
   / 
</span>


<span  class="active">
  <a href="https://mohyddin.tk/portfolio/steam-doctor/">STEAM DOCTOR</a>
  
</span>

</div>

    
    <main id="content" class="portfolio">

<h1>STEAM DOCTOR</h1>
<div class="tags">


  <div class="techs portfolio-tags">
    <div class="icon">
  <svg width="18px" height="18px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M112.125 86.25H103.5V34.5c0-6.325-5.175-11.5-11.5-11.5H23c-6.325 0-11.5 5.175-11.5 11.5v51.75H2.875A2.883 2.883 0 0 0 0 89.125v8.625C0 107.237 7.763 115 17.25 115h80.5c9.487 0 17.25-7.763 17.25-17.25v-8.625a2.883 2.883 0 0 0-2.875-2.875zm-92-51.75c0-1.558 1.317-2.875 2.875-2.875h69c1.558 0 2.875 1.317 2.875 2.875v51.75h-74.75V34.5zm86.25 63.25c0 4.756-3.869 8.625-8.625 8.625h-80.5c-4.756 0-8.625-3.869-8.625-8.625v-2.875H41.13c1.001 1.687 2.764 2.875 4.87 2.875h23c2.106 0 3.867-1.188 4.87-2.875h32.505v2.875zM49.892 70.015l2.032-2.032a2.875 2.875 0 0 0 0-4.066L45.506 57.5l6.416-6.418a2.875 2.875 0 0 0 0-4.067l-2.032-2.032a2.875 2.875 0 0 0-4.066 0L35.34 55.466a2.875 2.875 0 0 0 0 4.066l10.483 10.483a2.877 2.877 0 0 0 4.068 0zm13.185-2.03l2.033 2.032a2.875 2.875 0 0 0 4.066 0L79.66 59.534a2.875 2.875 0 0 0 0-4.066L69.176 44.985a2.875 2.875 0 0 0-4.066 0l-2.032 2.032a2.875 2.875 0 0 0 0 4.066l6.416 6.417-6.416 6.418a2.875 2.875 0 0 0 0 4.067z" />
  
  </svg>
</div>

    <span>
      
          <a href="https://mohyddin.tk/techs/c&#43;&#43;/">C&#43;&#43;</a>
        
      <span>- </span>
          <a href="https://mohyddin.tk/techs/arduino/">Arduino</a>
        
      <span>- </span>
          <a href="https://mohyddin.tk/techs/embedded-system/">Embedded System</a>
        
      
    </span>
  </div>




<div class="portfolio-tags">
  <div class="icon">
  <svg width="18px" height="18px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M77.577 51.23a1.807 1.807 0 0 0-2.2.342l-27.562 27.79a1.807 1.807 0 0 1-2.2.342l-14.008-9.702a1.807 1.807 0 0 0-2.2.342l-1.952 1.968c-.287.22-.456.568-.455.936.001.37.172.716.46.934L45.637 86.77a1.807 1.807 0 0 0 2.2-.342l31.709-31.97c.287-.22.456-.567.455-.936a1.175 1.175 0 0 0-.46-.933l-1.963-1.36z"/><path d="M97.304 20H80.512c-.041.34-.063.683-.064 1.026a5.986 5.986 0 0 0 1.256 4.1c.054.003.103.02.157.025a4.881 4.881 0 0 1 1.865-.025c3.05.562 4.984 3.907 4.32 7.47-.666 3.563-3.678 5.996-6.728 5.433a4.932 4.932 0 0 1-2.437-1.258c-6.018-1.378-10.445-7.795-10.445-15.745 0-.347.023-.685.04-1.026H34.579c-.041.34-.063.683-.064 1.026a5.986 5.986 0 0 0 1.256 4.1c.054.003.103.02.157.025a4.881 4.881 0 0 1 1.865-.025c3.05.562 4.984 3.907 4.32 7.47-.666 3.563-3.678 5.996-6.728 5.433a4.932 4.932 0 0 1-2.437-1.258c-6.018-1.378-10.445-7.795-10.445-15.745 0-.22.019-.434.025-.652a9.788 9.788 0 0 0-5.697 4.471 9.683 9.683 0 0 0-2.65 4.764L1.158 92.871c-.965 4.689 2.6 8.503 7.948 8.503h6.334v2.673c-.077 5.41 4.263 9.861 9.705 9.953h72.16c5.438-.095 9.774-4.546 9.694-9.953V29.953c.08-5.407-4.256-9.858-9.695-9.953zM10.078 96.653c-2.378 0-3.964-1.697-3.535-3.782L16.637 43.84h80.787L87.331 92.871a5.254 5.254 0 0 1-5.091 3.782H10.078zm91.535 7.394c.036 2.403-1.891 4.382-4.308 4.424h-72.16c-2.42-.04-4.352-2.018-4.32-4.424v-2.673h60.443c5.348 0 10.484-3.814 11.449-8.503l8.897-43.215v54.391z"/><path d="M34.814 33c1.243 0 2.251-1.057 2.251-2.36 0-1.305-1.008-2.362-2.25-2.362-2.04 0-4.313-3.194-4.313-7.778s2.272-7.778 4.312-7.778c1.227 0 2.536 1.163 3.386 3.084H43C41.716 11.19 38.578 8 34.814 8 29.871 8 26 13.49 26 20.5c0 7.009 3.871 12.5 8.814 12.5z"/>
  
  </svg>
</div>

  <span>2020</span>
</div></div>


<h3>Demo</h3>
<div class="">
    <video controls width="308" height="auto">
      <source src="/portfolio/steam-doctor/steamdc.mp4" type="video/mp4">
      Sorry, your browser doesn't support video elements.
      </video>
</div>


<p>Steam Doctor is a disinfection chamber designed to provide steam powered sterialization for people in public places. It also has audio/visual output features.</p>
<p>In this project I was responsible for design and development of the firmware that operates the system.</p>
<h3 id="requirements">Requirements:</h3>
<p>¬†
The system is required to have the following properties:</p>
<ul>
<li>Detect human presence.</li>
<li>Output audio feedback through speakers to notify the user about status and/or call to action.</li>
<li>Take user&rsquo;s temperature.</li>
<li>dispatch sterilising steam.</li>
<li>Read user&rsquo;s proximity inside the chamber.</li>
<li>Output Text on two LCD screens (8x2 and 16x4).</li>
<li>Detect Water level inside boiler</li>
<li>Auto fill the boiler from disinfectant solution container.</li>
<li>LED lights for visual status feedback.</li>
<li>Output Error Messages (audio/text/LED).</li>
<li>Auto disperse steam every x seconds to get rid of any condensation.</li>
</ul>
<figure>
    <img src="3d-render.jpeg"
         alt="Steam Doctor 3d Rendered Initial Design proposal"/> <figcaption>
            <p>Steam Doctor 3d Rendered Initial Design proposal</p>
        </figcaption>
</figure>

<figure>
    <img src="sd-front.jpeg"
         alt="Steam Doctor Front Portrait"/> <figcaption>
            <p>Steam Doctor Front Portrait</p>
        </figcaption>
</figure>

<h3 id="workflow">Workflow:</h3>
<p>The basic workflow of the machine is as follows:</p>
<ul>
<li>The user enters into the chamber.</li>
<li>Machine Greets Him (audio and on the screen).</li>
<li>User is asked to get closer in order to take temperature.</li>
<li>After taking his temperature, machine will output feedback about his temperature (Normal, or High)</li>
<li>Steam is released for x seconds.</li>
<li>Output thank you feedback.</li>
<li>Wait for next user.</li>
</ul>
<p>This workflow is running infinitely, and during this flow the machine is always self monitoring to look for any issues and respond accordingly. For instance when water level inside the boiler drops below a certain threshold, the machine checks the water level inside the main solution container, and then check if it has enough solution to refill the boiler.</p>
<figure>
    <img src="front.jpeg"
         alt="Closer View of Steam Doctor Front Panel"/> <figcaption>
            <p>Closer View of Steam Doctor Front Panel</p>
        </figcaption>
</figure>

<h3 id="challenges">Challenges:</h3>
<p>¬†
When you think about the system requirements, it might sound easy to implement. I mean indeed, the system requirements could be simply described as collect a bunch of data from various sensors, send output to screens, play audio through speakers and open/close some valves. Pretty simple, what could go wrong? apparently, many things.. I wouldn&rsquo;t consider myself to be an advanced embedded systems engineer, however, I always have managed to get around projects using my software skills, in addition to my partner&rsquo;s electronics skills. However, this project, is much more complex and delicate than any other similar project I have worked with, for the very fact that it has some dangerous properties which could lead to serious damage if not controlled strictly. I could ramble and go into a lot of details just describing the challenges that I have faced while working on this project, but that would really make this post extremely long, so I will only about the one I found to be most challenging to me (feel free to reach out if you would like to have some discussion about it).</p>
<figure>
    <img src="garbage-lcd.jpeg"
         alt="Steam Doctor Example of an LCD Garbage Output"/> <figcaption>
            <p>Steam Doctor Example of an LCD Garbage Output</p>
        </figcaption>
</figure>

<p>The single most challenging issue about this project I would say is Writing the whole system to run in non-blocking mode, i.e no delays are allowed (I did use some but maybe or two for very short duration), however, the machine is controlled using an ATMega256 micro-controller, meaning the whole system is to be run synchronously on a single thread. I would say this was the most critical challenge of the whole project and the reason for this is that there are two thermostats to be controlled while the system is running to make sure that boiler would never go above or below certain temperature and pressure thresholds, so imagine if the system in a state where the thermostats are ON and something block the execution thread. This could lead to really serious damages. There are safety valves installed on the boiler of course, but I have learned that I should take nothing for granted when working with hardware, because it can fail unexpectedly, one of the main reasons I dislike embedded systems projects.</p>
<p>Also at the time of building the project, there was an open issue with a core arduino library wire.h that had been open for more than 9 years! This library is used by the sensors which were communicating over i2c. The issue was that in case of a problem during transmission of the data, the system will block, not just the sensor that cause it, the whole arduino code will hang forever until manual reset. Thankfully, I found another library that implement a timeout behaviour to mitigate that, but this wasn&rsquo;t ideal because any libraries that were relying on wire.h had to be changed into the new one, and every time there is an update for say the LCD library, it had to be modified manually. Luckily though just before handing over the project, the arduino wire.h library patched a fix, and we switched to that.</p>
<p>Techniques used to mitigate this challenge:</p>
<ul>
<li>Avoid using delay() and revert to using mills() which is a way to fake asynchronous execution on a single threaded micro-controller.</li>
<li>Use watchdog timer as a safety fallback for when the system hangs if an error occur at the i2c bus.(which happened few times in testing)</li>
<li>We also decided to use a second micro-controller chip to monitor the temperature and pressure inside the boiler and shut the system off in case of an emergency. However,this didn&rsquo;t make it to the MVP).</li>
</ul>
<h3 id="things-i-would-do-differently">Things I would do differently</h3>
<p>During the initial phase of system design, I realised that this system is a perfect candidate for a state machine design pattern. However, my C++ skills are a bit rusty and I was behind a very tight deadline for the MVP handover and I didn&rsquo;t want to risk breaking the contract, so I wrote a simpler code. However, I&rsquo;m totally certain that a state machine would have made things much much easier to maintain, debug and understand.</p>
<h3 id="results">Results:</h3>
<p>The MVP was delivered successfully and I learned a ton of things from it, however, there is a huge risk involved with such product (again I&rsquo;m not a embedded systems expert nor I aspire to be one). Also, I believe that this project is definitely not a good fit for a freelance to take into production because many domains and stakeholders need to be involved (firmware engineers, electronics engineers, testing, product designer, legal, safety engineer, etc..), and the client had nothing close to that nor was showed a will to do so, so eventually after the handover of the prototype, I decided to not proceed any further with it.</p>
      </main>
  </div>
  <footer>
    <div class="footer-wrapper">
      <p style="font-size: x-small;">Made with ‚ù§Ô∏è &mdash; Powered by <a href="https://gohugo.io/" target="_blank" rel="external">Hugo</a>. Icons come from the great <a href="https://fontawesome.com/license" target="_blank" rel="external">Font Awesome</a> library</p>
      <p>¬© Mohyddin Tash</p>
    </div>
  </footer>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:500,600|Raleway:400,400i,600" rel="stylesheet">
  
</body>
</html>
